<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.3.2">Jekyll</generator><link href="http://localhost:4000/template-pintereso-bootstrap-jekyll/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/template-pintereso-bootstrap-jekyll/" rel="alternate" type="text/html" /><updated>2023-05-07T21:42:49+08:00</updated><id>http://localhost:4000/template-pintereso-bootstrap-jekyll/feed.xml</id><title type="html">itol.toolkit Gallery</title><subtitle>Collecting visulization plot by iTOL and workflow of itol.toolkit</subtitle><entry><title type="html">Collapse by range id</title><link href="http://localhost:4000/template-pintereso-bootstrap-jekyll/COLLAPSE_1/" rel="alternate" type="text/html" title="Collapse by range id" /><published>2023-05-05T00:00:00+08:00</published><updated>2023-05-05T00:00:00+08:00</updated><id>http://localhost:4000/template-pintereso-bootstrap-jekyll/COLLAPSE_1</id><content type="html" xml:base="http://localhost:4000/template-pintereso-bootstrap-jekyll/COLLAPSE_1/"><![CDATA[<h2 id="introduction">Introduction</h2>

<p><code class="language-plaintext highlighter-rouge">COLLAPSE</code> template are used to collapse branches.</p>

<p>Typically, The user merges branches A and B by folding them at their most recent common ancestor (MRCA). However, it is normally hard for users to declare the MRCA node directly. The node name is usually generated automatically by software rather than specified by the user when building the phylogenetic tree. Some programs do not even generate the node name.</p>

<p>This section has taken these complicated cases into account, and provide the corresponding solution, so that users can easily prepare the input data.</p>

<h2 id="range-id">Range ID</h2>

<p>This basic grammar for range id is written as: <code class="language-plaintext highlighter-rouge">branch_A|branch_B</code>.</p>

<p>This section provides an example of how to collapse branches using <a href="https://github.com/TongZhou2017/itol.toolkit/tree/master/inst/extdata/dataset1">dataset 1</a> (refer to the <a href="https://tongzhou2017.github.io/itol.toolkit/articles/Datasets.html">Dataset</a> for detail information) document for detailed information). Users can download the data locally from the provided link above. The files are read using a relative path in this document, so please adjust the path based on actual situation.</p>

<p>The first step is to load the <code class="language-plaintext highlighter-rouge">newick</code> format tree file <code class="language-plaintext highlighter-rouge">tree_of_itol_templates.tree</code> and its corresponding metadata <code class="language-plaintext highlighter-rouge">template_groups</code>.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">itol.toolkit</span><span class="p">)</span><span class="w">
</span><span class="n">tree</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">system.file</span><span class="p">(</span><span class="s2">"extdata"</span><span class="p">,</span><span class="w">
                    </span><span class="s2">"tree_of_itol_templates.tree"</span><span class="p">,</span><span class="w">
                    </span><span class="n">package</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"itol.toolkit"</span><span class="p">)</span><span class="w">
</span><span class="n">data</span><span class="p">(</span><span class="s2">"template_groups"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>Suppose that the user wants to collapse <code class="language-plaintext highlighter-rouge">DATASET_SIMPLEBAR</code> and <code class="language-plaintext highlighter-rouge">DATASET_MULTIBAR</code> into one branch; <code class="language-plaintext highlighter-rouge">DATASET_TEXT</code> and <code class="language-plaintext highlighter-rouge">LABELS</code> into another branch;<code class="language-plaintext highlighter-rouge">DATASET_ALIGNMENT</code>, <code class="language-plaintext highlighter-rouge">DATASET_CONNECTIONS</code>, <code class="language-plaintext highlighter-rouge">DATASET_IMAGE</code> and <code class="language-plaintext highlighter-rouge">POPUP_INFO</code> which belong to advanced visualization into one branch:</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">range_ids</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s2">"DATASET_SIMPLEBAR|DATASET_MULTIBAR"</span><span class="p">,</span><span class="w">
               </span><span class="s2">"DATASET_TEXT|LABELS"</span><span class="p">,</span><span class="w">
               </span><span class="s2">"DATASET_CONNECTIONS|POPUP_INFO"</span><span class="p">)</span><span class="w">
</span><span class="n">unit_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">range_ids</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"E001_collapse_1"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"COLLAPSE"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">)</span><span class="w">
</span><span class="n">write_unit</span><span class="p">(</span><span class="n">unit_1</span><span class="p">,</span><span class="w">
           </span><span class="n">paste0</span><span class="p">(</span><span class="n">getwd</span><span class="p">(),</span><span class="s2">"/E001_collapse_1.txt"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p>While the first two sets of folded branches are relatively simple to define because no other branches exist between them, the third set of folded branches is slightly complex, requiring the user to select the two branches with the longest spacing among the four to accurately describe the extent to be folded. Writing the code as <code class="language-plaintext highlighter-rouge">DATASET_ALIGNMENT | POPUP_INFO</code> may result in the omission of the <code class="language-plaintext highlighter-rouge">DATASET_CONNECTIONS</code> branch, because the branch does not belong to MCRA of <code class="language-plaintext highlighter-rouge">DATASET_ALIGNMENT</code> and <code class="language-plaintext highlighter-rouge">POPUP_INFO</code>.</p>

<p>Because the process of defining branches is very cumbersome and requires manual judgment, this function is not used frequently in the 23 templates in iTOL v6.</p>]]></content><author><name></name></author><category term="COLLAPSE" /><category term="Tree structure" /><summary type="html"><![CDATA[Introduction]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/template-pintereso-bootstrap-jekyll/assets/images/COLLAPSE_1.png" /><media:content medium="image" url="http://localhost:4000/template-pintereso-bootstrap-jekyll/assets/images/COLLAPSE_1.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Collapse by node id</title><link href="http://localhost:4000/template-pintereso-bootstrap-jekyll/COLLAPSE_2/" rel="alternate" type="text/html" title="Collapse by node id" /><published>2023-05-05T00:00:00+08:00</published><updated>2023-05-05T00:00:00+08:00</updated><id>http://localhost:4000/template-pintereso-bootstrap-jekyll/COLLAPSE_2</id><content type="html" xml:base="http://localhost:4000/template-pintereso-bootstrap-jekyll/COLLAPSE_2/"><![CDATA[<h2 id="introduction">Introduction</h2>

<p><code class="language-plaintext highlighter-rouge">COLLAPSE</code> template are used to collapse branches.</p>

<p>Typically, The user merges branches A and B by folding them at their most recent common ancestor (MRCA). However, it is normally hard for users to declare the MRCA node directly. The node name is usually generated automatically by software rather than specified by the user when building the phylogenetic tree. Some programs do not even generate the node name.</p>

<p>This section has taken these complicated cases into account, and provide the corresponding solution, so that users can easily prepare the input data.</p>

<h2 id="node-id">Node ID</h2>

<p>Although we used a tip label in the above example, using node names directly is more convenient if it is available. Thus, the <code class="language-plaintext highlighter-rouge">itol.toolkit</code> also enable you to define the collapsed branch using the node name directly .</p>

<p>The tree provided by <code class="language-plaintext highlighter-rouge">itol.toolkit</code> <a href="https://github.com/TongZhou2017/itol.toolkit/blob/master/inst/extdata/dataset1/itol_templates.tree">dataset 1</a> including the node labels:</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ape</span><span class="o">::</span><span class="n">read.tree</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="w">
</span><span class="c1"># Phylogenetic tree with 23 tips and 22 internal nodes.</span><span class="w">
</span><span class="c1">#</span><span class="w">
</span><span class="c1"># Tip labels:</span><span class="w">
</span><span class="c1">#   SPACING, COLLAPSE, PRUNE, TREE_COLORS, DATASET_STYLE, DATASET_CONNECTIONS, ...</span><span class="w">
</span><span class="c1"># Node labels:</span><span class="w">
</span><span class="c1">#   I1, I2, tree_sturcture, I4, theme_style, I6, ...</span><span class="w">
</span><span class="c1"># </span><span class="w">
</span><span class="c1"># Rooted; includes branch lengths.</span><span class="w">
</span></code></pre></div></div>

<p>Therefore, you could specify the group you want to merge directly.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">group_names</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="s2">"tree_sturcture"</span><span class="p">,</span><span class="w"> </span><span class="s2">"theme_style"</span><span class="p">,</span><span class="w"> </span><span class="s2">"text"</span><span class="p">,</span><span class="w"> </span><span class="s2">"basic_plot"</span><span class="p">))</span><span class="w">
</span><span class="n">unit_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">group_names</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"E002_collapse_2"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"COLLAPSE"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">)</span><span class="w">
</span><span class="n">write_unit</span><span class="p">(</span><span class="n">unit_2</span><span class="p">,</span><span class="w">
           </span><span class="n">paste0</span><span class="p">(</span><span class="n">getwd</span><span class="p">(),</span><span class="s2">"/E002_collapse_2.txt"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>

<p>If you have questions about how to upload results files from iTOL toolkit for interactive visualization on iTOL, please refer to the <a href="https://tongzhou2017.github.io/itol.toolkit/articles/Operation.html">Operation</a> document for step-by-step guidance.</p>]]></content><author><name></name></author><category term="COLLAPSE" /><category term="Tree structure" /><summary type="html"><![CDATA[Introduction]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/template-pintereso-bootstrap-jekyll/assets/images/COLLAPSE_2.png" /><media:content medium="image" url="http://localhost:4000/template-pintereso-bootstrap-jekyll/assets/images/COLLAPSE_2.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Text alignment &amp;amp; 20+ colors</title><link href="http://localhost:4000/template-pintereso-bootstrap-jekyll/Li2022Fig2/" rel="alternate" type="text/html" title="Text alignment &amp;amp; 20+ colors" /><published>2023-05-05T00:00:00+08:00</published><updated>2023-05-05T00:00:00+08:00</updated><id>http://localhost:4000/template-pintereso-bootstrap-jekyll/Li2022Fig2</id><content type="html" xml:base="http://localhost:4000/template-pintereso-bootstrap-jekyll/Li2022Fig2/"><![CDATA[<p>DOI: 10.1016/j.jhazmat.2022.129230</p>

<p>Figure 2</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">itol.toolkit</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span><span class="w"> 
</span><span class="n">library</span><span class="p">(</span><span class="n">ape</span><span class="p">)</span><span class="w"> 
</span><span class="n">library</span><span class="p">(</span><span class="n">stringr</span><span class="p">)</span><span class="w"> 

</span><span class="n">tree</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/TongZhou2017/itol.toolkit/master/inst/extdata/dataset2/tree.nwk"</span><span class="w"> 

</span><span class="n">hub</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_hub</span><span class="p">(</span><span class="n">tree</span><span class="p">)</span><span class="w">

</span><span class="n">data_file</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/TongZhou2017/itol.toolkit/master/inst/extdata/dataset2/metadata.txt"</span><span class="w">
</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.table</span><span class="o">::</span><span class="n">fread</span><span class="p">(</span><span class="n">data_file</span><span class="p">)</span><span class="w">
</span><span class="n">data</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">ID</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">"Seq30_"</span><span class="p">)</span><span class="w">

</span><span class="n">select_tip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">phylo</span><span class="o">$</span><span class="n">tip.label</span><span class="p">[</span><span class="n">phylo</span><span class="o">$</span><span class="n">tip.label</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="s2">"Seq372"</span><span class="p">]</span><span class="w">
</span><span class="n">unit_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">select_tip</span><span class="p">,</span><span class="w"> 
                                 </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Li2022jhm_1_prune"</span><span class="p">,</span><span class="w"> 
                                 </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"PRUNE"</span><span class="p">,</span><span class="w"> 
                                 </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">)</span><span class="w">

</span><span class="n">df_gene</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Gene_name</span><span class="p">)</span><span class="w">
</span><span class="n">unit_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_gene</span><span class="p">,</span><span class="w"> 
                                 </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Li2022jhm_4_text_1"</span><span class="p">,</span><span class="w"> 
                                 </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_TEXT"</span><span class="p">,</span><span class="w"> 
                                 </span><span class="n">size_factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
                                 </span><span class="n">rotation</span><span class="o">=</span><span class="w"> </span><span class="m">180</span><span class="p">,</span><span class="w">
                                 </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w">
                                 </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#000000"</span><span class="p">,</span><span class="w">
                                 </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">)</span><span class="w">
</span><span class="n">unit_2</span><span class="o">@</span><span class="n">common_themes</span><span class="o">$</span><span class="n">basic_theme</span><span class="o">$</span><span class="n">margin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">-500</span><span class="w">

</span><span class="n">df_relabel</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Substrate</span><span class="p">)</span><span class="w">
</span><span class="n">unit_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_relabel</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Li2022jhm_2_labels"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"LABELS"</span><span class="p">,</span><span class="w">
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">)</span><span class="w">

</span><span class="n">df_substrate</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Substrate</span><span class="p">)</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">666</span><span class="p">)</span><span class="w">
</span><span class="n">unit_4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_substrate</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Li2022jhm_3_range"</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"TREE_COLORS"</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">subtype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"range"</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"wesanderson"</span><span class="p">,</span><span class="w">
                    </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">)</span><span class="w">

</span><span class="n">df_species</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Species</span><span class="p">)</span><span class="w">
</span><span class="n">unit_5</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_species</span><span class="p">,</span><span class="w"> 
                                 </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Li2022jhm_5_text_2"</span><span class="p">,</span><span class="w"> 
                                 </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_TEXT"</span><span class="p">,</span><span class="w"> 
                                 </span><span class="n">size_factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
                                 </span><span class="n">rotation</span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w">
                                 </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">-1</span><span class="p">,</span><span class="w">
                                 </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="s2">"#000000"</span><span class="p">,</span><span class="w">
                                 </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree</span><span class="p">)</span><span class="w">
</span><span class="n">unit_5</span><span class="o">@</span><span class="n">common_themes</span><span class="o">$</span><span class="n">basic_theme</span><span class="o">$</span><span class="n">margin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">50</span><span class="w">

</span><span class="n">hub</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hub</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unit_1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unit_2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unit_3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unit_4</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">unit_5</span><span class="w">
</span><span class="n">write_hub</span><span class="p">(</span><span class="n">hub</span><span class="p">,</span><span class="w"> </span><span class="n">getwd</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>]]></content><author><name></name></author><category term="PRUNE" /><category term="DATASET_TEXT" /><category term="LABELS" /><category term="TREE_COLORS" /><category term="Functional Genomics" /><summary type="html"><![CDATA[DOI: 10.1016/j.jhazmat.2022.129230]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/template-pintereso-bootstrap-jekyll/assets/images/Li2022Fig2.png" /><media:content medium="image" url="http://localhost:4000/template-pintereso-bootstrap-jekyll/assets/images/Li2022Fig2.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Abuntant OTU</title><link href="http://localhost:4000/template-pintereso-bootstrap-jekyll/Zheng2022Fig3ALeft/" rel="alternate" type="text/html" title="Abuntant OTU" /><published>2023-05-05T00:00:00+08:00</published><updated>2023-05-05T00:00:00+08:00</updated><id>http://localhost:4000/template-pintereso-bootstrap-jekyll/Zheng2022Fig3ALeft</id><content type="html" xml:base="http://localhost:4000/template-pintereso-bootstrap-jekyll/Zheng2022Fig3ALeft/"><![CDATA[<p>DOI: 10.1016/j.envpol.2022.120243</p>

<p>Figure 3A Left</p>

<h2 id="fig3-left">Fig3 left</h2>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">itol.toolkit</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span><span class="w">

</span><span class="n">tree_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/TongZhou2017/itol.toolkit/master/inst/extdata/dataset3/abunt-tree.nwk"</span><span class="w">
</span><span class="n">hub_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_hub</span><span class="p">(</span><span class="n">tree_1</span><span class="p">)</span><span class="w">
</span><span class="n">data_file_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/TongZhou2017/itol.toolkit/master/inst/extdata/dataset3/abunt-metadata.txt"</span><span class="w">
</span><span class="n">data_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.table</span><span class="o">::</span><span class="n">fread</span><span class="p">(</span><span class="n">data_file_1</span><span class="p">)</span><span class="w">

</span><span class="c1"># relabel by genus</span><span class="w">
</span><span class="n">unit_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Genus</span><span class="p">),</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_3al_1_labels"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"LABELS"</span><span class="p">,</span><span class="w">
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_1</span><span class="p">)</span><span class="w">

</span><span class="c1"># tree_colors range by phylum</span><span class="w">
</span><span class="n">unit_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Phylum</span><span class="p">),</span><span class="w"> 
                    </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_3al_2_range"</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"TREE_COLORS"</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">subtype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"range"</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_1</span><span class="p">)</span><span class="w">

</span><span class="c1"># color_strip by class</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">
</span><span class="n">unit_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="p">),</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_3al_3_strip"</span><span class="p">,</span><span class="w">
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_COLORSTRIP"</span><span class="p">,</span><span class="w">
                      </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"wesanderson"</span><span class="p">,</span><span class="w">
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_1</span><span class="p">)</span><span class="w">
</span><span class="n">unit_3</span><span class="o">@</span><span class="n">common_themes</span><span class="o">$</span><span class="n">basic_theme</span><span class="o">$</span><span class="n">margin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">50</span><span class="w">

</span><span class="c1"># simple_bar by NS</span><span class="w">
</span><span class="n">unit_4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">NS</span><span class="p">),</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_3al_4_simplebar"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_SIMPLEBAR"</span><span class="p">,</span><span class="w">
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_1</span><span class="p">)</span><span class="w">
</span><span class="n">unit_4</span><span class="o">@</span><span class="n">specific_themes</span><span class="o">$</span><span class="n">basic_plot</span><span class="o">$</span><span class="n">size_max</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span><span class="w">

</span><span class="c1"># simple_bar by OS</span><span class="w">
</span><span class="n">unit_5</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">OS</span><span class="p">),</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_3al_5_simplebar"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_SIMPLEBAR"</span><span class="p">,</span><span class="w">
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_1</span><span class="p">)</span><span class="w">
</span><span class="n">unit_5</span><span class="o">@</span><span class="n">specific_themes</span><span class="o">$</span><span class="n">basic_plot</span><span class="o">$</span><span class="n">size_max</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span><span class="w">

</span><span class="c1"># simple_bar by OS</span><span class="w">
</span><span class="n">unit_6</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Dissimilarity</span><span class="p">),</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_3al_6_gradient"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_GRADIENT"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_1</span><span class="p">)</span><span class="w">
</span><span class="c1">#unit_6@specific_themes$heatmap$color$min &lt;- "#0000ff"</span><span class="w">
</span><span class="c1">#unit_6@specific_themes$heatmap$color$max &lt;- "#ff0000"</span><span class="w">
</span><span class="n">hub_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hub_1</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">unit_1</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">unit_2</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">unit_3</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">unit_4</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">unit_5</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">unit_6</span><span class="w">
</span><span class="n">write_hub</span><span class="p">(</span><span class="n">hub_1</span><span class="p">,</span><span class="n">getwd</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>]]></content><author><name></name></author><category term="LABELS" /><category term="TREE_COLORS" /><category term="DATASET_COLORSTRIP" /><category term="DATASET_SIMPLEBAR" /><category term="DATASET_GRADIENT" /><category term="Microbiome" /><summary type="html"><![CDATA[DOI: 10.1016/j.envpol.2022.120243]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/template-pintereso-bootstrap-jekyll/assets/images/Zheng2022Fig3ALeft.png" /><media:content medium="image" url="http://localhost:4000/template-pintereso-bootstrap-jekyll/assets/images/Zheng2022Fig3ALeft.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">iCAMP</title><link href="http://localhost:4000/template-pintereso-bootstrap-jekyll/Zheng2022Fig4/" rel="alternate" type="text/html" title="iCAMP" /><published>2023-05-05T00:00:00+08:00</published><updated>2023-05-05T00:00:00+08:00</updated><id>http://localhost:4000/template-pintereso-bootstrap-jekyll/Zheng2022Fig4</id><content type="html" xml:base="http://localhost:4000/template-pintereso-bootstrap-jekyll/Zheng2022Fig4/"><![CDATA[<p>DOI: 10.1016/j.envpol.2022.120243</p>

<p>Figure 4</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">itol.toolkit</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span><span class="w">

</span><span class="n">tree_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/TongZhou2017/itol.toolkit/master/inst/extdata/dataset3/assembly-tree.nwk"</span><span class="w">
</span><span class="n">hub_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_hub</span><span class="p">(</span><span class="n">tree_3</span><span class="p">)</span><span class="w">
</span><span class="n">data_file_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/TongZhou2017/itol.toolkit/master/inst/extdata/dataset3/assembly-metadata.txt"</span><span class="w">
</span><span class="n">data_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.table</span><span class="o">::</span><span class="n">fread</span><span class="p">(</span><span class="n">data_file_3</span><span class="p">)</span><span class="w">

</span><span class="c1"># tree_colors range by phylum</span><span class="w">
</span><span class="n">unit_13</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_3</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Phylum</span><span class="p">),</span><span class="w"> 
                    </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_4a_1_range"</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"TREE_COLORS"</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">subtype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"range"</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_3</span><span class="p">)</span><span class="w">
</span><span class="n">write_unit</span><span class="p">(</span><span class="n">unit_13</span><span class="p">,</span><span class="w">
           </span><span class="n">paste0</span><span class="p">(</span><span class="n">getwd</span><span class="p">(),</span><span class="s2">"/rep_Zheng2022ep_4a_2_range.txt"</span><span class="p">))</span><span class="w">

</span><span class="n">top_10_NS</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data_3</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="n">`NS-bar`</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">`NS-bar`</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">pull</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w">
</span><span class="n">top_10_OS</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data_3</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="n">`OS-bar`</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">arrange</span><span class="p">(</span><span class="n">desc</span><span class="p">(</span><span class="n">`OS-bar`</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">head</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">pull</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w">
</span><span class="n">RA_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data_3</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">mutate</span><span class="p">(</span><span class="n">pct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">`OS-bar`</span><span class="o">+</span><span class="n">`NS-bar`</span><span class="o">/</span><span class="nf">sum</span><span class="p">(</span><span class="n">data_3</span><span class="o">$</span><span class="n">`OS-bar`</span><span class="p">,</span><span class="n">data_3</span><span class="o">$</span><span class="n">`NS-bar`</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">pct</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">arrange</span><span class="p">(</span><span class="n">pct</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">pct</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="m">1</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">pull</span><span class="p">(</span><span class="n">ID</span><span class="p">)</span><span class="w">
</span><span class="n">RA_ids</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="n">top_10_NS</span><span class="p">,</span><span class="n">top_10_OS</span><span class="p">,</span><span class="n">RA_1</span><span class="p">))</span><span class="w">
</span><span class="n">df_text</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.frame</span><span class="p">(</span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">RA_ids</span><span class="p">,</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="s2">"#"</span><span class="p">,</span><span class="nf">length</span><span class="p">(</span><span class="n">RA_ids</span><span class="p">)))</span><span class="w">
</span><span class="n">unit_14</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_text</span><span class="p">,</span><span class="w"> 
                       </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_4a_3_text"</span><span class="p">,</span><span class="w"> 
                       </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_TEXT"</span><span class="p">,</span><span class="w">
                       </span><span class="n">size_factor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w">
                       </span><span class="n">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9</span><span class="p">,</span><span class="w">
                       </span><span class="n">rotation</span><span class="o">=</span><span class="m">0</span><span class="p">,</span><span class="w">
                       </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"#000000"</span><span class="p">,</span><span class="w">
                       </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_3</span><span class="p">)</span><span class="w">
</span><span class="n">write_unit</span><span class="p">(</span><span class="n">unit_14</span><span class="p">,</span><span class="w">
           </span><span class="n">paste0</span><span class="p">(</span><span class="n">getwd</span><span class="p">(),</span><span class="s2">"/rep_Zheng2022ep_4a_3_text.txt"</span><span class="p">))</span><span class="w">

</span><span class="n">df_cap_NS</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data_3</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">starts_with</span><span class="p">(</span><span class="s2">"NS"</span><span class="p">))</span><span class="w">
</span><span class="n">df_bar_NS</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_cap_NS</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="n">ends_with</span><span class="p">(</span><span class="s2">"bar"</span><span class="p">))</span><span class="w">
</span><span class="n">df_cap_NS</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_cap_NS</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="n">ends_with</span><span class="p">(</span><span class="s2">"bar"</span><span class="p">))</span><span class="w">
</span><span class="n">unit_15</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_cap_NS</span><span class="p">,</span><span class="w"> 
                       </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_4a_4_heatmap"</span><span class="p">,</span><span class="w">
                       </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_HEATMAP"</span><span class="p">,</span><span class="w"> 
                       </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_3</span><span class="p">)</span><span class="w">
</span><span class="n">write_unit</span><span class="p">(</span><span class="n">unit_15</span><span class="p">,</span><span class="w">
           </span><span class="n">paste0</span><span class="p">(</span><span class="n">getwd</span><span class="p">(),</span><span class="s2">"/rep_Zheng2022ep_4a_4_heatmap.txt"</span><span class="p">))</span><span class="w">

</span><span class="c1"># simple_bar by OS</span><span class="w">
</span><span class="n">df_bar_NS</span><span class="o">$</span><span class="n">`NS-bar`</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">df_bar_NS</span><span class="o">$</span><span class="n">`NS-bar`</span><span class="p">,</span><span class="m">3</span><span class="p">)</span><span class="w">
</span><span class="n">unit_16</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_bar_NS</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_4a_6_simplebar"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_SIMPLEBAR"</span><span class="p">,</span><span class="w">
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_3</span><span class="p">)</span><span class="w">
</span><span class="n">unit_16</span><span class="o">@</span><span class="n">specific_themes</span><span class="o">$</span><span class="n">basic_plot</span><span class="o">$</span><span class="n">size_max</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span><span class="w">
</span><span class="n">write_unit</span><span class="p">(</span><span class="n">unit_16</span><span class="p">,</span><span class="w">
           </span><span class="n">paste0</span><span class="p">(</span><span class="n">getwd</span><span class="p">(),</span><span class="s2">"/rep_Zheng2022ep_4a_6_simplebar.txt"</span><span class="p">))</span><span class="w">

</span><span class="n">df_cap_OS</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data_3</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">starts_with</span><span class="p">(</span><span class="s2">"OS"</span><span class="p">))</span><span class="w">
</span><span class="n">df_bar_OS</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_cap_OS</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="n">ends_with</span><span class="p">(</span><span class="s2">"bar"</span><span class="p">))</span><span class="w">
</span><span class="n">df_cap_OS</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">df_cap_OS</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="o">-</span><span class="n">ends_with</span><span class="p">(</span><span class="s2">"bar"</span><span class="p">))</span><span class="w">
</span><span class="n">unit_17</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_cap_OS</span><span class="p">,</span><span class="w"> 
                       </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_4a_7_heatmap"</span><span class="p">,</span><span class="w">
                       </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_HEATMAP"</span><span class="p">,</span><span class="w"> 
                       </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_3</span><span class="p">)</span><span class="w">
</span><span class="n">write_unit</span><span class="p">(</span><span class="n">unit_17</span><span class="p">,</span><span class="w">
           </span><span class="n">paste0</span><span class="p">(</span><span class="n">getwd</span><span class="p">(),</span><span class="s2">"/rep_Zheng2022ep_4a_7_heatmap.txt"</span><span class="p">))</span><span class="w">

</span><span class="c1"># simple_bar by OS</span><span class="w">
</span><span class="n">df_bar_OS</span><span class="o">$</span><span class="n">`OS-bar`</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">round</span><span class="p">(</span><span class="n">df_bar_OS</span><span class="o">$</span><span class="n">`OS-bar`</span><span class="p">,</span><span class="m">3</span><span class="p">)</span><span class="w">
</span><span class="n">unit_18</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">df_bar_OS</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_4a_8_simplebar"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_SIMPLEBAR"</span><span class="p">,</span><span class="w">
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_3</span><span class="p">)</span><span class="w">
</span><span class="n">unit_18</span><span class="o">@</span><span class="n">specific_themes</span><span class="o">$</span><span class="n">basic_plot</span><span class="o">$</span><span class="n">size_max</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span><span class="w">
</span><span class="n">write_unit</span><span class="p">(</span><span class="n">unit_18</span><span class="p">,</span><span class="w">
           </span><span class="n">paste0</span><span class="p">(</span><span class="n">getwd</span><span class="p">(),</span><span class="s2">"/rep_Zheng2022ep_4a_8_simplebar.txt"</span><span class="p">))</span><span class="w">
</span></code></pre></div></div>]]></content><author><name></name></author><category term="TREE_COLORS" /><category term="DATASET_TEXT" /><category term="DATASET_HEATMAP" /><category term="DATASET_SIMPLEBAR" /><category term="Microbiome" /><summary type="html"><![CDATA[DOI: 10.1016/j.envpol.2022.120243]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/template-pintereso-bootstrap-jekyll/assets/images/Zheng2022Fig3ALeft.png" /><media:content medium="image" url="http://localhost:4000/template-pintereso-bootstrap-jekyll/assets/images/Zheng2022Fig3ALeft.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Shape &amp;amp; Colors by Two Factors</title><link href="http://localhost:4000/template-pintereso-bootstrap-jekyll/Zhou2022Fig4/" rel="alternate" type="text/html" title="Shape &amp;amp; Colors by Two Factors" /><published>2023-05-05T00:00:00+08:00</published><updated>2023-05-05T00:00:00+08:00</updated><id>http://localhost:4000/template-pintereso-bootstrap-jekyll/Zhou2022Fig4</id><content type="html" xml:base="http://localhost:4000/template-pintereso-bootstrap-jekyll/Zhou2022Fig4/"><![CDATA[<p>DOI: 10.1016/j.foodres.2022.111998</p>

<p>Figure 2</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">itol.toolkit</span><span class="p">)</span><span class="w"> </span><span class="c1"># main package</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span><span class="w"> </span><span class="c1"># data manipulation</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span><span class="w"> </span><span class="c1"># file read</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">ape</span><span class="p">)</span><span class="w"> </span><span class="c1"># tree operation</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">stringr</span><span class="p">)</span><span class="w"> </span><span class="c1"># string operation</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">tidyr</span><span class="p">)</span><span class="w"> </span><span class="c1"># data manipulation</span><span class="w">

</span><span class="n">tree_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/TongZhou2017/itol.toolkit/master/inst/extdata/dataset4/otus.contree"</span><span class="w">
</span><span class="n">hub_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_hub</span><span class="p">(</span><span class="n">tree_1</span><span class="p">)</span><span class="w">
</span><span class="n">data_file_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/TongZhou2017/itol.toolkit/master/inst/extdata/dataset4/annotation.txt"</span><span class="w">
</span><span class="n">data_file_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"https://raw.githubusercontent.com/TongZhou2017/itol.toolkit/master/inst/extdata/dataset4/otutab_high.mean"</span><span class="w">
</span><span class="n">data_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.table</span><span class="o">::</span><span class="n">fread</span><span class="p">(</span><span class="n">data_file_1</span><span class="p">)</span><span class="w">
</span><span class="n">data_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.table</span><span class="o">::</span><span class="n">fread</span><span class="p">(</span><span class="n">data_file_2</span><span class="p">)</span><span class="w">

</span><span class="c1"># relabel by genus</span><span class="w">
</span><span class="n">unit_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Genus</span><span class="p">),</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zhou_1_labels"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"LABELS"</span><span class="p">,</span><span class="w">
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_1</span><span class="p">)</span><span class="w">
</span><span class="n">write_unit</span><span class="p">(</span><span class="n">unit_1</span><span class="p">)</span><span class="w">

</span><span class="c1"># tree_colors range by phylum</span><span class="w">
</span><span class="n">unit_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Phylum</span><span class="p">),</span><span class="w"> 
                    </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zhou_2_range"</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"TREE_COLORS"</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">subtype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"range"</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_1</span><span class="p">)</span><span class="w">
</span><span class="n">write_unit</span><span class="p">(</span><span class="n">unit_2</span><span class="p">)</span><span class="w">

</span><span class="c1"># color_strip by class</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">
</span><span class="n">unit_3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="p">),</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zhou_3_strip"</span><span class="p">,</span><span class="w">
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_COLORSTRIP"</span><span class="p">,</span><span class="w">
                      </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"wesanderson"</span><span class="p">,</span><span class="w">
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_1</span><span class="p">)</span><span class="w">
</span><span class="n">unit_3</span><span class="o">@</span><span class="n">common_themes</span><span class="o">$</span><span class="n">basic_theme</span><span class="o">$</span><span class="n">margin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">50</span><span class="w">

</span><span class="c1"># simple_bar by NS</span><span class="w">
</span><span class="n">unit_4</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">South_America</span><span class="p">,</span><span class="w"> </span><span class="n">Asia</span><span class="p">,</span><span class="w"> </span><span class="n">North_America</span><span class="p">),</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zhou_4_multibar"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_MULTIBAR"</span><span class="p">,</span><span class="w">
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_1</span><span class="p">)</span><span class="w">
</span><span class="n">unit_4</span><span class="o">@</span><span class="n">specific_themes</span><span class="o">$</span><span class="n">basic_plot</span><span class="o">$</span><span class="n">size_max</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span><span class="w">

</span><span class="c1">#Adding comment tag</span><span class="w">
</span><span class="n">unit_5</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_1</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="p">,</span><span class="w"> </span><span class="n">Family</span><span class="p">),</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zhou_5_binary"</span><span class="p">,</span><span class="w">
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_DOMAINS"</span><span class="p">,</span><span class="w">
                      </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"wesanderson"</span><span class="p">,</span><span class="w">
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_1</span><span class="p">)</span><span class="w">


</span><span class="c1">#Storing drawing information</span><span class="w">
</span><span class="n">hub_1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hub_1</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">unit_1</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">unit_2</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">unit_3</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">unit_4</span><span class="w"> </span><span class="o">+</span><span class="w">
  </span><span class="n">unit_5</span><span class="w">
  
</span><span class="n">write_hub</span><span class="p">(</span><span class="n">hub_1</span><span class="p">,</span><span class="n">getwd</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>]]></content><author><name></name></author><category term="LABELS" /><category term="TREE_COLORS" /><category term="DATASET_COLORSTRIP" /><category term="DATASET_MULTIBAR" /><category term="DATASET_DOMAINS" /><category term="Microbiome" /><summary type="html"><![CDATA[DOI: 10.1016/j.foodres.2022.111998]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/template-pintereso-bootstrap-jekyll/assets/images/Zhou2022Fig4.svg" /><media:content medium="image" url="http://localhost:4000/template-pintereso-bootstrap-jekyll/assets/images/Zhou2022Fig4.svg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Rare OTU</title><link href="http://localhost:4000/template-pintereso-bootstrap-jekyll/web-concepts-library/" rel="alternate" type="text/html" title="Rare OTU" /><published>2018-01-12T00:00:00+08:00</published><updated>2018-01-12T00:00:00+08:00</updated><id>http://localhost:4000/template-pintereso-bootstrap-jekyll/web-concepts-library</id><content type="html" xml:base="http://localhost:4000/template-pintereso-bootstrap-jekyll/web-concepts-library/"><![CDATA[<h2 id="fig3-right">Fig3 right</h2>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">library</span><span class="p">(</span><span class="n">itol.toolkit</span><span class="p">)</span><span class="w">
</span><span class="n">library</span><span class="p">(</span><span class="n">data.table</span><span class="p">)</span><span class="w">

</span><span class="n">tree_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"~/Downloads/itol.annotation-package.output/10.1016j.envpol.2022.120243/Fig.3/Rare-tree/rare-tree.nwk"</span><span class="w">
</span><span class="n">hub_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_hub</span><span class="p">(</span><span class="n">tree_2</span><span class="p">)</span><span class="w">
</span><span class="n">data_file_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s2">"~/Downloads/itol.annotation-package.output/10.1016j.envpol.2022.120243/Fig.3/Rare-tree/metadata.txt"</span><span class="w">
</span><span class="n">data_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">data.table</span><span class="o">::</span><span class="n">fread</span><span class="p">(</span><span class="n">data_file_2</span><span class="p">)</span><span class="w">

</span><span class="c1"># relabel by genus</span><span class="w">
</span><span class="n">unit_7</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Genus</span><span class="p">),</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_3ar_1_labels"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"LABELS"</span><span class="p">,</span><span class="w">
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_2</span><span class="p">)</span><span class="w">

</span><span class="c1"># tree_colors range by phylum</span><span class="w">
</span><span class="n">unit_8</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Phylum</span><span class="p">),</span><span class="w"> 
                    </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_3ar_2_range"</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"TREE_COLORS"</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">subtype</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"range"</span><span class="p">,</span><span class="w"> 
                    </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_2</span><span class="p">)</span><span class="w">

</span><span class="c1"># color_strip by class</span><span class="w">
</span><span class="n">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span><span class="w">
</span><span class="n">unit_9</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Class</span><span class="p">),</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_3ar_3_strip"</span><span class="p">,</span><span class="w">
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_COLORSTRIP"</span><span class="p">,</span><span class="w">
                      </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"wesanderson"</span><span class="p">,</span><span class="w">
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_2</span><span class="p">)</span><span class="w">
</span><span class="n">unit_9</span><span class="o">@</span><span class="n">common_themes</span><span class="o">$</span><span class="n">basic_theme</span><span class="o">$</span><span class="n">margin</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">50</span><span class="w">

</span><span class="c1"># simple_bar by NS</span><span class="w">
</span><span class="n">unit_10</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">NS</span><span class="p">),</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_3ar_4_simplebar"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_SIMPLEBAR"</span><span class="p">,</span><span class="w">
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_2</span><span class="p">)</span><span class="w">
</span><span class="n">unit_10</span><span class="o">@</span><span class="n">specific_themes</span><span class="o">$</span><span class="n">basic_plot</span><span class="o">$</span><span class="n">size_max</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span><span class="w">

</span><span class="c1"># simple_bar by OS</span><span class="w">
</span><span class="n">unit_11</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">OS</span><span class="p">),</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_3ar_5_simplebar"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_SIMPLEBAR"</span><span class="p">,</span><span class="w">
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_2</span><span class="p">)</span><span class="w">
</span><span class="n">unit_11</span><span class="o">@</span><span class="n">specific_themes</span><span class="o">$</span><span class="n">basic_plot</span><span class="o">$</span><span class="n">size_max</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span><span class="w">

</span><span class="c1"># simple_bar by OS</span><span class="w">
</span><span class="n">unit_12</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">create_unit</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">data_2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="n">select</span><span class="p">(</span><span class="n">ID</span><span class="p">,</span><span class="w"> </span><span class="n">Dissimilarity</span><span class="p">),</span><span class="w"> 
                      </span><span class="n">key</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"rep_Zheng2022ep_3ar_6_gradient"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"DATASET_GRADIENT"</span><span class="p">,</span><span class="w"> 
                      </span><span class="n">tree</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tree_2</span><span class="p">)</span><span class="w">
</span><span class="c1">#unit_6@specific_themes$heatmap$color$min &lt;- "#0000ff"</span><span class="w">
</span><span class="c1">#unit_6@specific_themes$heatmap$color$max &lt;- "#ff0000"</span><span class="w">
</span><span class="n">hub_2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">hub_2</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">unit_7</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">unit_8</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">unit_9</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">unit_10</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">unit_11</span><span class="w"> </span><span class="o">+</span><span class="w"> 
  </span><span class="n">unit_12</span><span class="w">
</span><span class="n">write_hub</span><span class="p">(</span><span class="n">hub_2</span><span class="p">,</span><span class="n">getwd</span><span class="p">())</span><span class="w">
</span></code></pre></div></div>]]></content><author><name></name></author><category term="LABELS" /><category term="TREE_COLORS" /><category term="DATASET_COLORSTRIP" /><category term="DATASET_SIMPLEBAR" /><category term="DATASET_GRADIENT" /><category term="Microbiome" /><summary type="html"><![CDATA[Fig3 right]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="http://localhost:4000/template-pintereso-bootstrap-jekyll/assets/images/Zheng2022Fig3ARight.png" /><media:content medium="image" url="http://localhost:4000/template-pintereso-bootstrap-jekyll/assets/images/Zheng2022Fig3ARight.png" xmlns:media="http://search.yahoo.com/mrss/" /></entry></feed>